---
layout: post
title: LMAG Run
---

# Let's make a Game: Run!

We'll be re-creating a game called [Run!](http://www.lessmilk.com/games/1/), made by [Thomas Palef](http://www.lessmilk.com) ([@thomaspalef](http://www.twitter.com/thomaspalef)) as a part of his "1 Game a Week" challenge.

![Run!](http://www.lessmilk.com/img/12_1.png)

## Our Goal

In this game the player will be evading an onslaught of enemies coming from all directions as their score rises. When the player collides with an enemy the game will end. You can play the finished product below:

(INSERT GAME HERE)

When we're finished this game will utilize timed spawns that will add an enemy coming from a random direction, as well as time based score and basic player controls. We'll also be utilizing and implementing some of Phaser's features such as audio, collision detection, and animation.

## Getting Started

### The Webpage

Before we start creating the game, we need somewhere to display it. Create a folder and name it **Run**. In this folder create a file and name it **index.html**. This will be the web page that will contain our game. In this file we'll add the following code:

{% highlight html %}
<!DOCTYPE html>
<html>
    
<head>
  <meta charset="utf-8" />
  <title>Run!</title>

  <style>
    #game_div {
      width: 350px;
      height: 350px;
      margin: auto;
      margin-top: 50px;
    }
  </style>

  <script type="text/javascript" src="phaser.min.js"></script>
  <script type="text/javascript" src="main.js"></script>
</head>

<body>

  <div id="game_div"> </div>

</body>

</html>
{% endhighlight %}

The **game_div** section of our page will be what contains the game itself. To display our game properly we've styled the **game_div** with a few CSS properties giving it the proper dimensions and positioning to match what we want for our game. In this case our game will be displayed in a 350x350 area on the page.

### Main Script

In our web page we included a file named **main.js**. This will be the script that initializes and starts our game. In this file we'll add the following code:

{% highlight js %}
var game = new Phaser.Game(350, 350, Phaser.AUTO, 'game_div');
{% endhighlight %}

This line of code initializes Phaser and sets up a few necessary things such as the **width** and **height** of our visible game world, and what <div> to display it in. Our **width** and **height** must match the size we gave to the **game_div** section of our web page, otherwise things will show stretched and skewed.

## Adding States

The game is organized into various states, each with their own set of instructions. The first one we'll be creating is the *Load* state.

### Load State

We can start by declaring this state in our *main.js*.

{% highlight js %}
game.state.add('Load', Game.Load);
{% endhighlight %}

The *Load* state will handle loading all of our assets, handling global variables, and displaying the loading screen. This will be the starting state for the game. So we'll add the following line to *main.js*

{% highlight js %}
game.state.start('Load');
{% endhighlight %}

Now let's create a new file, *load.js*. This will contain all the code associated with our *Load* state.

{% highlight js %}
Game = {};

Game.Load = function (game) { };

Game.Load.prototype = {
  preload: function () {
    // Executed before create(),
    // Loads assets
  },

  create: function () {
    // Logic after loading
  },
}
{% endhighlight %}

This is the skeleton of our *Load* state. Here we declared our global reference to the Game object that allows us to access the various states from anywhere in our code.

(Insert picture)

Above is what we'll have to show after completing the *Load* state. The first thing we need to do is setup the loading screen. To do so we'll add the following to our *preload* function:

{% highlight js %}
game.stage.backgroundColor = '#34495e';

label = game.add.text(175, 175, 'loading...', { font: '30px Arial', fill: '#fff' });
label.anchor.setTo(0.5, 0.5);
{% endhighlight %}